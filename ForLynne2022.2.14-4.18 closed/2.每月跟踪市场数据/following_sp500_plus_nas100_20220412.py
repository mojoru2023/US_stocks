#!-"- coding:utf-8 -*-



import datetime
import time

import pymysql
import requests
from lxml import etree
import json
from queue import Queue
import threading
from requests.exceptions import RequestException



def run_forever(func):
    def wrapper(obj):
        while True:
            func(obj)
    return wrapper


def RemoveDot(item):
    f_l = []
    for it in item:

        f_str = "".join(it.split(","))
        ff_str = f_str +"00"
        f_l.append(ff_str)

    return f_l

def remove_douhao(num):
    num1 = "".join(num.split(","))
    f_num = str(num1)
    return f_num
def remove_block(items):
    new_items = []
    for it in items:
        f = "".join(it.split())
        new_items.append(f)
    return new_items
def call_page(url):
    try:
        response = requests.get(url)
        if response.status_code == 200:
            return response.text
        return None
    except RequestException:
        return None


class Sp_plus_Nas_StockPool(object):

    def __init__(self,url):
        self.url = url

    def page_request(self):
        ''' 发送请求获取数据 '''
        headers = {
            'User-Agent': 'Mozilla/5.0 (Linux; Android 4.2.1; M040 Build/JOP40D) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.59 Mobile Safari/537.36'
        }

        response = requests.get(self.url,headers=headers)
        if response.status_code == 200:
            html = response.text
            return html
        else:
            pass

    def page_parse_(self):
        '''根据页面内容使用lxml解析数据, 获取段子列表'''


        html  = self.page_request()
        element = etree.HTML(html)
        now_price = element.xpath(
            '//*[@id="spFP"]/div[1]/span[1]/text()')
        f_price = RemoveDot(remove_block(now_price))
        big_list.append(float(f_price[0]))
        print(f_price[0])
        return big_list



def insertDB(content):
    connection = pymysql.connect(host='127.0.0.1', port=3306, user='root', password='123456', db='ForLynne',
                                 charset='utf8mb4', cursorclass=pymysql.cursors.DictCursor)
    cursor = connection.cursor()
    try:
        f_ls = "%s," * 525
        print(len(f_ls[:-1].split(",")))
        cursor.executemany('insert into following_sp500_plus_nas100_20220412 ({0}) values ({1})'.format(sp500_plus_nas100_forDB,f_ls[:-1]),content)
        connection.commit()
        connection.commit()
        connection.close()
        print('向MySQL中添加数据成功！')
    except TypeError:
        pass



def compare_(base_dt_list):
    print(len(base_dt_list[2:]))
    print(len(big_list[2:]))
    sp500_ = (float(big_list[0]) - float(base_dt_list[0])) / float(base_dt_list[0])
    nas100_ = (float(big_list[1]) - float(base_dt_list[1])) / float(base_dt_list[1])
    f_compare_content.append(str(round(sp500_, 5)))
    f_compare_content.append(str(round(nas100_, 5)))

    for i1, i2 in zip(big_list[2:], base_dt_list[2:]):
        if (((float(i1) - float(i2)) / float(i2)) - Alpha_dt) > max(float(f_compare_content[0]), float(f_compare_content[1])):
            print((float(i1) - float(i2)) / float(i2) - Alpha_dt)
            print(max(sp500_, nas100_))

            f_compare_content.append(round(((float(i1) - float(i2)) / float(i2)), 5))
        else:
            print(round(((float(i1) - float(i2)) / float(i2))))
            f_compare_content.append("")

    # add sp500_nas100_spread
    sp500_nas100_spread = round(float(i1) / float(i2),5)
    f_compare_content.append(sp500_nas100_spread)

#select * from sp_nas_netprofits_fromsina;

if __name__ == "__main__":
    sp500_plus_nas100_forSearch = "INX,IXIC,AAPL,A,AAL,AAP,ABBV,ABC,ABMD,ABT,ACN,ADBE,ADI,ADM,ADP,ADS,ADSK,AEE,AEP,AES,AFL,AIG,AIV,AIZ,AJG,AKAM,ALB,ALGN,ALK,ALL,ALLE,ALXN,AMAT,AMCR,AMD,AME,AMGN,AMP,AMT,AMZN,ANET,ANSS,ANTM,AON,AOS,APA,APD,APH,APTV,ARE,ASML,ATO,ATVI,AVB,AVGO,AVY,AWK,AXP,AZO,BA,BAC,BAX,BBY,BDX,BEN,BF.B,BIDU,BIIB,BK,BKNG,BKR,BLK,BLL,BMRN,BMY,BR,BRK.B,BSX,BWA,BXP,C,CAG,CAH,CARR,CAT,CB,CBOE,CBRE,CCI,CCL,CDNS,CDW,CE,CERN,CF,CFG,CHD,CHKP,CHRW,CHTR,CI,CINF,CL,CLX,CMA,CMCSA,CME,CMG,CMI,CMS,CNC,CNP,COF,COG,COO,COP,COST,COTY,CPB,CPRT,CRM,CSCO,CSGP,CSX,CTAS,CTL,CTSH,CTVA,CTXS,CVS,CVX,CXO,D,DAL,DD,DE,DFS,DG,DGX,DHI,DHR,DIS,DISCA,DISCK,DISH,DLR,DLTR,DOV,DOW,DPZ,DRE,DRI,DTE,DUK,DVA,DVN,DXC,DXCM,EA,EBAY,ECL,ED,EFX,EIX,EL,EMN,EMR,EOG,EQIX,EQR,ES,ESS,ETFC,ETN,ETR,EVRG,EW,EXC,EXPD,EXPE,EXR,F,FANG,FAST,FB,FBHS,FCX,FDX,FE,FFIV,FIS,FISV,FITB,FLIR,FLS,FLT,FMC,FOX,FOXA,FRC,FRT,FTI,FTNT,FTV,GD,GE,GILD,GIS,GL,GLW,GM,GOOG,GOOGL,GPC,GPN,GPS,GRMN,GS,GWW,HAL,HAS,HBAN,HBI,HCA,HD,HES,HFC,HIG,HII,HLT,HOG,HOLX,HON,HPE,HPQ,HRB,HRL,HSIC,HST,HSY,HUM,HWM,IBM,ICE,IDXX,IEX,IFF,ILMN,INCY,INFO,INTC,INTU,IP,IPG,IPGP,IQV,IR,IRM,ISRG,IT,ITW,IVZ,J,JBHT,JCI,JD,JKHY,JNJ,JNPR,JPM,JWN,K,KEY,KEYS,KHC,KIM,KLAC,KMB,KMI,KMX,KO,KR,KSS,KSU,L,LB,LBTYA,LBTYK,LDOS,LEG,LEN,LH,LHX,LIN,LKQ,LLY,LMT,LNC,LNT,LOW,LRCX,LULU,LUV,LVS,LW,LYB,LYV,MA,MAA,MAR,MAS,MCD,MCHP,MCK,MCO,MDLZ,MDT,MELI,MET,MGM,MHK,MKC,MKTX,MLM,MMC,MMM,MNST,MO,MOS,MPC,MRK,MRO,MS,MSCI,MSFT,MSI,MTB,MTD,MU,MXIM,MYL,NBL,NCLH,NDAQ,NEE,NEM,NFLX,NI,NKE,NLOK,NLSN,NOC,NOV,NOW,NRG,NSC,NTAP,NTES,NTRS,NUE,NVDA,NVR,NWL,NWS,NWSA,NXPI,O,ODFL,OKE,OMC,ORCL,ORLY,OTIS,OXY,PAYC,PAYX,PBCT,PCAR,PEAK,PEG,PEP,PFE,PFG,PG,PGR,PH,PHM,PKG,PKI,PLD,PM,PNC,PNR,PNW,PPG,PPL,PRGO,PRU,PSA,PSX,PVH,PWR,PXD,PYPL,QCOM,QRVO,RCL,RE,REG,REGN,RF,RHI,RJF,RL,RMD,ROK,ROL,ROP,ROST,RSG,RTX,SBAC,SBUX,SCHW,SEE,SGEN,SHW,SIRI,SIVB,SJM,SLB,SLG,SNA,SNPS,SO,SPG,SPGI,SPLK,SRE,STE,STT,STX,STZ,SWK,SWKS,SYF,SYK,SYY,T,TAP,TCOM,TDG,TEL,TFC,TFX,TGT,TIF,TJX,TMO,TMUS,TPR,TROW,TRV,TSCO,TSLA,TSN,TT,TTWO,TWTR,TXN,TXT,UA,UAA,UAL,UDR,UHS,ULTA,UNH,UNM,UNP,UPS,URI,USB,V,VAR,VFC,VIAC,VLO,VMC,VNO,VRSK,VRSN,VRTX,VTR,VZ,WAB,WAT,WBA,WDAY,WDC,WEC,WELL,WFC,WHR,WLTW,WM,WMB,WMT,WRB,WRK,WST,WU,WY,WYNN,XEL,XLNX,XOM,XRAY,XRX,XYL,YUM,ZBH,ZBRA,ZION,ZTS"
    sp500_plus_nas100_forNetProfits = "AAPL,A,AAL,AAP,ABBV,ABC,ABMD,ABT,ACN,ADBE,ADI,ADM,ADP,ADS,ADSK,AEE,AEP,AES,AFL,AIG,AIV,AIZ,AJG,AKAM,ALB,ALGN,ALK,ALL,ALLE,ALXN,AMAT,AMCR,AMD,AME,AMGN,AMP,AMT,AMZN,ANET,ANSS,ANTM,AON,AOS,APA,APD,APH,APTV,ARE,ASML,ATO,ATVI,AVB,AVGO,AVY,AWK,AXP,AZO,BA,BAC,BAX,BBY,BDX,BEN,BF.B,BIDU,BIIB,BK,BKNG,BKR,BLK,BLL,BMRN,BMY,BR,BRK.B,BSX,BWA,BXP,C,CAG,CAH,CARR,CAT,CB,CBOE,CBRE,CCI,CCL,CDNS,CDW,CE,CERN,CF,CFG,CHD,CHKP,CHRW,CHTR,CI,CINF,CL,CLX,CMA,CMCSA,CME,CMG,CMI,CMS,CNC,CNP,COF,COG,COO,COP,COST,COTY,CPB,CPRT,CRM,CSCO,CSGP,CSX,CTAS,CTL,CTSH,CTVA,CTXS,CVS,CVX,CXO,D,DAL,DD,DE,DFS,DG,DGX,DHI,DHR,DIS,DISCA,DISCK,DISH,DLR,DLTR,DOV,DOW,DPZ,DRE,DRI,DTE,DUK,DVA,DVN,DXC,DXCM,EA,EBAY,ECL,ED,EFX,EIX,EL,EMN,EMR,EOG,EQIX,EQR,ES,ESS,ETFC,ETN,ETR,EVRG,EW,EXC,EXPD,EXPE,EXR,F,FANG,FAST,FB,FBHS,FCX,FDX,FE,FFIV,FIS,FISV,FITB,FLIR,FLS,FLT,FMC,FOX,FOXA,FRC,FRT,FTI,FTNT,FTV,GD,GE,GILD,GIS,GL,GLW,GM,GOOG,GOOGL,GPC,GPN,GPS,GRMN,GS,GWW,HAL,HAS,HBAN,HBI,HCA,HD,HES,HFC,HIG,HII,HLT,HOG,HOLX,HON,HPE,HPQ,HRB,HRL,HSIC,HST,HSY,HUM,HWM,IBM,ICE,IDXX,IEX,IFF,ILMN,INCY,INFO,INTC,INTU,IP,IPG,IPGP,IQV,IR,IRM,ISRG,IT,ITW,IVZ,J,JBHT,JCI,JD,JKHY,JNJ,JNPR,JPM,JWN,K,KEY,KEYS,KHC,KIM,KLAC,KMB,KMI,KMX,KO,KR,KSS,KSU,L,LB,LBTYA,LBTYK,LDOS,LEG,LEN,LH,LHX,LIN,LKQ,LLY,LMT,LNC,LNT,LOW,LRCX,LULU,LUV,LVS,LW,LYB,LYV,MA,MAA,MAR,MAS,MCD,MCHP,MCK,MCO,MDLZ,MDT,MELI,MET,MGM,MHK,MKC,MKTX,MLM,MMC,MMM,MNST,MO,MOS,MPC,MRK,MRO,MS,MSCI,MSFT,MSI,MTB,MTD,MU,MXIM,MYL,NBL,NCLH,NDAQ,NEE,NEM,NFLX,NI,NKE,NLOK,NLSN,NOC,NOV,NOW,NRG,NSC,NTAP,NTES,NTRS,NUE,NVDA,NVR,NWL,NWS,NWSA,NXPI,O,ODFL,OKE,OMC,ORCL,ORLY,OTIS,OXY,PAYC,PAYX,PBCT,PCAR,PEAK,PEG,PEP,PFE,PFG,PG,PGR,PH,PHM,PKG,PKI,PLD,PM,PNC,PNR,PNW,PPG,PPL,PRGO,PRU,PSA,PSX,PVH,PWR,PXD,PYPL,QCOM,QRVO,RCL,RE,REG,REGN,RF,RHI,RJF,RL,RMD,ROK,ROL,ROP,ROST,RSG,RTX,SBAC,SBUX,SCHW,SEE,SGEN,SHW,SIRI,SIVB,SJM,SLB,SLG,SNA,SNPS,SO,SPG,SPGI,SPLK,SRE,STE,STT,STX,STZ,SWK,SWKS,SYF,SYK,SYY,T,TAP,TCOM,TDG,TEL,TFC,TFX,TGT,TIF,TJX,TMO,TMUS,TPR,TROW,TRV,TSCO,TSLA,TSN,TT,TTWO,TWTR,TXN,TXT,UA,UAA,UAL,UDR,UHS,ULTA,UNH,UNM,UNP,UPS,URI,USB,V,VAR,VFC,VIAC,VLO,VMC,VNO,VRSK,VRSN,VRTX,VTR,VZ,WAB,WAT,WBA,WDAY,WDC,WEC,WELL,WFC,WHR,WLTW,WM,WMB,WMT,WRB,WRK,WST,WU,WY,WYNN,XEL,XLNX,XOM,XRAY,XRX,XYL,YUM,ZBH,ZBRA,ZION,ZTS"
    sp500_plus_nas100_forDB = "INX,IXIC,AAPL,A,AAL,AAP,ABBV,ABC,ABMD,ABT,ACN,ADBE,ADI,ADM,ADP,ADS,ADSK,AEE,AEP,AES,AFL,AIG,AIV,AIZ,AJG,AKAM,ALB,ALGN,ALK,_ALL,ALLE,ALXN,AMAT,AMCR,AMD,AME,AMGN,AMP,AMT,AMZN,ANET,ANSS,ANTM,AON,AOS,APA,APD,APH,APTV,ARE,ASML,ATO,ATVI,AVB,AVGO,AVY,AWK,AXP,AZO,BA,BAC,BAX,BBY,BDX,BEN,BF_B,BIDU,BIIB,BK,BKNG,BKR,BLK,BLL,BMRN,BMY,BR,BRK_B,BSX,BWA,BXP,C,CAG,CAH,CARR,CAT,CB,CBOE,CBRE,CCI,CCL,CDNS,CDW,CE,CERN,CF,CFG,CHD,CHKP,CHRW,CHTR,CI,CINF,CL,CLX,CMA,CMCSA,CME,CMG,CMI,CMS,CNC,CNP,COF,COG,COO,COP,COST,COTY,CPB,CPRT,CRM,CSCO,CSGP,CSX,CTAS,CTL,CTSH,CTVA,CTXS,CVS,CVX,CXO,D,DAL,DD,DE,DFS,DG,DGX,DHI,DHR,DIS,DISCA,DISCK,DISH,DLR,DLTR,DOV,DOW,DPZ,DRE,DRI,DTE,DUK,DVA,DVN,DXC,DXCM,EA,EBAY,ECL,ED,EFX,EIX,EL,EMN,EMR,EOG,EQIX,EQR,ES,ESS,ETFC,ETN,ETR,EVRG,EW,EXC,EXPD,EXPE,EXR,F,FANG,FAST,FB,FBHS,FCX,FDX,FE,FFIV,FIS,FISV,FITB,FLIR,FLS,FLT,FMC,FOX,FOXA,FRC,FRT,FTI,FTNT,FTV,GD,GE,GILD,GIS,GL,GLW,GM,GOOG,GOOGL,GPC,GPN,GPS,GRMN,GS,GWW,HAL,HAS,HBAN,HBI,HCA,HD,HES,HFC,HIG,HII,HLT,HOG,HOLX,HON,HPE,HPQ,HRB,HRL,HSIC,HST,HSY,HUM,HWM,IBM,ICE,IDXX,IEX,IFF,ILMN,INCY,INFO,INTC,INTU,IP,IPG,IPGP,IQV,IR,IRM,ISRG,IT,ITW,IVZ,J,JBHT,JCI,JD,JKHY,JNJ,JNPR,JPM,JWN,K,_KEY,_KEYS,KHC,KIM,KLAC,KMB,KMI,KMX,KO,KR,KSS,KSU,L,LB,LBTYA,LBTYK,LDOS,LEG,LEN,LH,LHX,LIN,LKQ,LLY,LMT,LNC,LNT,LOW,LRCX,LULU,LUV,LVS,LW,LYB,LYV,MA,MAA,MAR,MAS,MCD,MCHP,MCK,MCO,MDLZ,MDT,MELI,MET,MGM,MHK,MKC,MKTX,MLM,MMC,MMM,MNST,MO,MOS,MPC,MRK,MRO,MS,MSCI,MSFT,MSI,MTB,MTD,MU,MXIM,MYL,NBL,NCLH,NDAQ,NEE,NEM,NFLX,NI,NKE,NLOK,NLSN,NOC,NOV,NOW,NRG,NSC,NTAP,NTES,NTRS,NUE,NVDA,NVR,NWL,NWS,NWSA,NXPI,O,ODFL,OKE,OMC,ORCL,ORLY,OTIS,OXY,PAYC,PAYX,PBCT,PCAR,PEAK,PEG,PEP,PFE,PFG,PG,PGR,PH,PHM,PKG,PKI,PLD,PM,PNC,PNR,PNW,PPG,PPL,PRGO,PRU,PSA,PSX,PVH,PWR,PXD,PYPL,QCOM,QRVO,RCL,RE,REG,REGN,RF,RHI,RJF,RL,RMD,ROK,ROL,ROP,ROST,RSG,RTX,SBAC,SBUX,SCHW,SEE,SGEN,SHW,SIRI,SIVB,SJM,SLB,SLG,SNA,SNPS,SO,SPG,SPGI,SPLK,SRE,STE,STT,STX,STZ,SWK,SWKS,SYF,SYK,SYY,T,TAP,TCOM,TDG,TEL,TFC,TFX,TGT,TIF,TJX,TMO,TMUS,TPR,TROW,TRV,TSCO,TSLA,TSN,TT,TTWO,TWTR,TXN,TXT,UA,UAA,UAL,UDR,UHS,ULTA,UNH,UNM,UNP,UPS,URI,USB,V,VAR,VFC,VIAC,VLO,VMC,VNO,VRSK,VRSN,VRTX,VTR,VZ,WAB,WAT,WBA,WDAY,WDC,WEC,WELL,WFC,WHR,WLTW,WM,WMB,WMT,WRB,WRK,WST,WU,WY,WYNN,XEL,XLNX,XOM,XRAY,XRX,XYL,YUM,ZBH,ZBRA,ZION,ZTS"
    Alpha_dt = 0.05
    list_sp500_plus_nas100_forSearch = sp500_plus_nas100_forSearch.split(",")
    s = datetime.datetime.now()
    big_list = []
    f_compare_content = []
    _2022_4_12= [('4392.59', '13351.08', '165.29', '126.44', '19.00', '218.68', '162.31', '161.31', '306.08', '117.69', '319.47', '420.44', '156.50', '96.91', '229.20', '56.80', '196.73', '96.25', '102.04', '24.41', '65.33', '63.03', '6.92', '189.30', '180.61', '118.99', '210.89', '409.82', '57.11', '141.16', '107.43', '182.50', '113.36', '11.67', '93.06', '127.05', '254.02', '290.73', '255.54', '3034.13', '126.58', '282.33', '516.72', '328.26', '63.79', '43.68', '246.84', '70.38', '107.51', '196.18', '597.87', '119.74', '78.93', '246.61', '573.85', '166.49', '166.16', '181.16', '2164.60', '181.94', '37.57', '76.44', '93.84', '271.68', '25.57', '68.50', '129.56', '212.55', '47.29', '2227.29', '37.29', '688.17', '87.15', '82.95', '77.51', '153.52', '344.33', '44.25', '37.01', '124.59', '50.93', '35.62', '62.96', '41.28', '227.81', '14.28', '117.33', '85.56', '192.68', '19.56', '149.80', '172.97', '145.17', '93.30', '108.41', '40.87', '102.65', '142.78', '103.28', '555.32', '259.21', '138.19', '80.94', '145.57', '88.37', '47.58', '237.66', '1603.17', '195.94', '71.55', '86.54', '32.40', '132.59', '22.25', '399.62', '101.37', '590.39', '8.56', '46.20', '116.98', '189.41', '51.17', '61.82', '35.06', '413.67', '11.00', '84.74', '61.01', '102.24', '103.68', '171.59', '65.60', '87.40', '42.36', '68.70', '436.75', '112.18', '248.77', '135.92', '72.51', '276.98', '130.47', '24.43', '24.42', '33.19', '145.02', '173.05', '146.39', '65.49', '387.24', '58.25', '131.45', '137.17', '114.85', '121.45', '62.56', '31.25', '492.11', '122.60', '54.15', '176.60', '98.03', '216.38', '71.84', '263.87', '107.91', '92.86', '122.94', '735.24', '90.43', '92.60', '345.51', '49.26', '139.91', '124.20', '70.81', '120.02', '49.03', '96.69', '191.55', '212.55', '15.48', '138.44', '56.01', '210.18', '69.64', '49.19', '205.74', '47.40', '199.53', '102.45', '99.67', '39.01', '57.34', '35.71', '258.67', '136.79', '35.85', '39.12', '160.75', '123.26', '8.00', '331.76', '58.18', '243.74', '90.83', '61.82', '70.92', '102.93', '33.69', '40.13', '2545.06', '2534.60', '130.94', '139.95', '14.11', '111.31', '321.64', '491.43', '40.76', '85.22', '13.36', '14.08', '260.94', '304.52', '114.72', '36.39', '74.95', '222.67', '155.58', '38.20', '76.33', '195.19', '15.38', '37.47', '26.78', '53.43', '91.36', '19.58', '225.98', '460.56', '35.48', '126.56', '124.53', '496.78', '190.56', '125.43', '336.49', '81.74', '108.61', '45.67', '465.11', '47.43', '34.49', '97.29', '238.48', '46.44', '55.42', '279.70', '298.10', '196.27', '21.00', '144.66', '172.01', '61.53', '56.56', '200.49', '179.90', '35.13', '126.12', '28.85', '67.88', '20.48', '143.93', '42.29', '25.13', '321.48', '126.42', '19.37', '91.79', '65.02', '58.32', '61.00', '293.59', '65.15', '40.48', '25.22', '25.86', '109.06', '35.87', '76.77', '269.04', '257.41', '318.52', '47.00', '301.86', '467.66', '64.92', '63.39', '201.28', '456.16', '390.78', '46.76', '36.96', '68.71', '107.58', '111.31', '357.82', '205.39', '180.51', '49.39', '250.51', '65.22', '323.25', '328.40', '63.72', '109.02', '1060.34', '70.64', '41.60', '123.71', '101.57', '265.45', '364.82', '169.76', '147.38', '82.59', '54.98', '76.05', '87.20', '86.91', '26.61', '84.76', '482.70', '279.83', '233.19', '159.56', '1318.36', '70.13', '103.14', '15.86', '8.46', '21.64', '178.55', '82.81', '84.77', '341.13', '31.75', '133.46', '26.64', '27.40', '467.20', '20.56', '507.33', '39.19', '263.06', '75.50', '95.06', '110.89', '165.32', '212.58', '4335.45', '22.41', '21.48', '21.17', '170.00', '72.61', '264.75', '71.30', '78.69', '79.45', '713.88', '74.75', '59.34', '319.36', '136.69', '19.41', '83.71', '35.03', '72.80', '171.90', '53.12', '73.95', '158.57', '112.11', '273.87', '42.21', '163.02', '161.42', '162.70', '101.77', '175.00', '52.43', '77.54', '128.27', '29.20', '35.98', '117.24', '408.50', '82.85', '79.34', '135.14', '254.75', '102.31', '136.91', '113.38', '82.58', '290.57', '70.58', '733.02', '20.73', '108.56', '111.80', '108.52', '234.21', '261.66', '34.90', '461.16', '103.08', '132.71', '104.27', '355.38', '79.50', '82.75', '67.42', '149.72', '252.90', '6.46', '507.06', '139.69', '43.25', '74.73', '211.16', '294.77', '75.99', '127.88', '387.59', '137.77', '171.25', '244.46', '75.81', '81.41', '251.42', '140.32', '117.73', '37.70', '261.70', '86.27', '19.54', '55.61', '23.14', '638.48', '120.88', '52.14', '336.62', '237.20', '131.46', '62.71', '568.90', '132.96', '33.74', '138.96', '184.24', '228.23', '985.00', '95.45', '148.05', '137.96', '45.08', '173.66', '68.65', '14.88', '16.06', '45.13', '57.58', '151.14', '415.65', '534.82', '32.76', '246.21', '188.02', '331.07', '52.71', '212.79', '177.07', '56.20', '29.58', '104.86', '174.77', '41.42', '213.30', '215.40', '287.97', '60.67', '53.83', '89.17', '295.39', '44.81', '224.67', '46.34', '103.19', '96.03', '46.35', '170.55', '231.56', '159.16', '35.52', '157.08', '68.22', '49.93', '381.22', '18.95', '39.90', '73.97', '74.34', '194.92', '87.83', '49.07', '18.79', '84.14', '122.97', '126.00', '393.68', '62.92', '187.30')][0]
    for it in list_sp500_plus_nas100_forSearch:
        url = "http://gu.qq.com/us{0}.OQ/gg".format(it)
        print(url)
        sp_nas = Sp_plus_Nas_StockPool(url)
        sp_nas.page_parse_()
    ff_l = []
    compare_(_2022_4_12)
    f_tup = tuple(f_compare_content)
    print(f_tup)
    ff_l.append((f_tup))
    print(ff_l)
    print(big_list)
    print(f_compare_content)
    insertDB(ff_l)
    e = datetime.datetime.now()
    print(e-s)





# 数据类型必须是text 不能是 float
# create table following_sp500_plus_nas100_20220412(id int not null primary key auto_increment,INX TEXT,IXIC TEXT,AAPL TEXT,A TEXT,AAL TEXT,AAP TEXT,ABBV TEXT,ABC TEXT,ABMD TEXT,ABT TEXT,ACN TEXT,ADBE TEXT,ADI TEXT,ADM TEXT,ADP TEXT,ADS TEXT,ADSK TEXT,AEE TEXT,AEP TEXT,AES TEXT,AFL TEXT,AIG TEXT,AIV TEXT,AIZ TEXT,AJG TEXT,AKAM TEXT,ALB TEXT,ALGN TEXT,ALK TEXT,_ALL TEXT,ALLE TEXT,ALXN TEXT,AMAT TEXT,AMCR TEXT,AMD TEXT,AME TEXT,AMGN TEXT,AMP TEXT,AMT TEXT,AMZN TEXT,ANET TEXT,ANSS TEXT,ANTM TEXT,AON TEXT,AOS TEXT,APA TEXT,APD TEXT,APH TEXT,APTV TEXT,ARE TEXT,ASML TEXT,ATO TEXT,ATVI TEXT,AVB TEXT,AVGO TEXT,AVY TEXT,AWK TEXT,AXP TEXT,AZO TEXT,BA TEXT,BAC TEXT,BAX TEXT,BBY TEXT,BDX TEXT,BEN TEXT,BF_B TEXT,BIDU TEXT,BIIB TEXT,BK TEXT,BKNG TEXT,BKR TEXT,BLK TEXT,BLL TEXT,BMRN TEXT,BMY TEXT,BR TEXT,BRK_B TEXT,BSX TEXT,BWA TEXT,BXP TEXT,C TEXT,CAG TEXT,CAH TEXT,CARR TEXT,CAT TEXT,CB TEXT,CBOE TEXT,CBRE TEXT,CCI TEXT,CCL TEXT,CDNS TEXT,CDW TEXT,CE TEXT,CERN TEXT,CF TEXT,CFG TEXT,CHD TEXT,CHKP TEXT,CHRW TEXT,CHTR TEXT,CI TEXT,CINF TEXT,CL TEXT,CLX TEXT,CMA TEXT,CMCSA TEXT,CME TEXT,CMG TEXT,CMI TEXT,CMS TEXT,CNC TEXT,CNP TEXT,COF TEXT,COG TEXT,COO TEXT,COP TEXT,COST TEXT,COTY TEXT,CPB TEXT,CPRT TEXT,CRM TEXT,CSCO TEXT,CSGP TEXT,CSX TEXT,CTAS TEXT,CTL TEXT,CTSH TEXT,CTVA TEXT,CTXS TEXT,CVS TEXT,CVX TEXT,CXO TEXT,D TEXT,DAL TEXT,DD TEXT,DE TEXT,DFS TEXT,DG TEXT,DGX TEXT,DHI TEXT,DHR TEXT,DIS TEXT,DISCA TEXT,DISCK TEXT,DISH TEXT,DLR TEXT,DLTR TEXT,DOV TEXT,DOW TEXT,DPZ TEXT,DRE TEXT,DRI TEXT,DTE TEXT,DUK TEXT,DVA TEXT,DVN TEXT,DXC TEXT,DXCM TEXT,EA TEXT,EBAY TEXT,ECL TEXT,ED TEXT,EFX TEXT,EIX TEXT,EL TEXT,EMN TEXT,EMR TEXT,EOG TEXT,EQIX TEXT,EQR TEXT,ES TEXT,ESS TEXT,ETFC TEXT,ETN TEXT,ETR TEXT,EVRG TEXT,EW TEXT,EXC TEXT,EXPD TEXT,EXPE TEXT,EXR TEXT,F TEXT,FANG TEXT,FAST TEXT,FB TEXT,FBHS TEXT,FCX TEXT,FDX TEXT,FE TEXT,FFIV TEXT,FIS TEXT,FISV TEXT,FITB TEXT,FLIR TEXT,FLS TEXT,FLT TEXT,FMC TEXT,FOX TEXT,FOXA TEXT,FRC TEXT,FRT TEXT,FTI TEXT,FTNT TEXT,FTV TEXT,GD TEXT,GE TEXT,GILD TEXT,GIS TEXT,GL TEXT,GLW TEXT,GM TEXT,GOOG TEXT,GOOGL TEXT,GPC TEXT,GPN TEXT,GPS TEXT,GRMN TEXT,GS TEXT,GWW TEXT,HAL TEXT,HAS TEXT,HBAN TEXT,HBI TEXT,HCA TEXT,HD TEXT,HES TEXT,HFC TEXT,HIG TEXT,HII TEXT,HLT TEXT,HOG TEXT,HOLX TEXT,HON TEXT,HPE TEXT,HPQ TEXT,HRB TEXT,HRL TEXT,HSIC TEXT,HST TEXT,HSY TEXT,HUM TEXT,HWM TEXT,IBM TEXT,ICE TEXT,IDXX TEXT,IEX TEXT,IFF TEXT,ILMN TEXT,INCY TEXT,INFO TEXT,INTC TEXT,INTU TEXT,IP TEXT,IPG TEXT,IPGP TEXT,IQV TEXT,IR TEXT,IRM TEXT,ISRG TEXT,IT TEXT,ITW TEXT,IVZ TEXT,J TEXT,JBHT TEXT,JCI TEXT,JD TEXT,JKHY TEXT,JNJ TEXT,JNPR TEXT,JPM TEXT,JWN TEXT,K TEXT,_KEY TEXT,_KEYS TEXT,KHC TEXT,KIM TEXT,KLAC TEXT,KMB TEXT,KMI TEXT,KMX TEXT,KO TEXT,KR TEXT,KSS TEXT,KSU TEXT,L TEXT,LB TEXT,LBTYA TEXT,LBTYK TEXT,LDOS TEXT,LEG TEXT,LEN TEXT,LH TEXT,LHX TEXT,LIN TEXT,LKQ TEXT,LLY TEXT,LMT TEXT,LNC TEXT,LNT TEXT,LOW TEXT,LRCX TEXT,LULU TEXT,LUV TEXT,LVS TEXT,LW TEXT,LYB TEXT,LYV TEXT,MA TEXT,MAA TEXT,MAR TEXT,MAS TEXT,MCD TEXT,MCHP TEXT,MCK TEXT,MCO TEXT,MDLZ TEXT,MDT TEXT,MELI TEXT,MET TEXT,MGM TEXT,MHK TEXT,MKC TEXT,MKTX TEXT,MLM TEXT,MMC TEXT,MMM TEXT,MNST TEXT,MO TEXT,MOS TEXT,MPC TEXT,MRK TEXT,MRO TEXT,MS TEXT,MSCI TEXT,MSFT TEXT,MSI TEXT,MTB TEXT,MTD TEXT,MU TEXT,MXIM TEXT,MYL TEXT,NBL TEXT,NCLH TEXT,NDAQ TEXT,NEE TEXT,NEM TEXT,NFLX TEXT,NI TEXT,NKE TEXT,NLOK TEXT,NLSN TEXT,NOC TEXT,NOV TEXT,NOW TEXT,NRG TEXT,NSC TEXT,NTAP TEXT,NTES TEXT,NTRS TEXT,NUE TEXT,NVDA TEXT,NVR TEXT,NWL TEXT,NWS TEXT,NWSA TEXT,NXPI TEXT,O TEXT,ODFL TEXT,OKE TEXT,OMC TEXT,ORCL TEXT,ORLY TEXT,OTIS TEXT,OXY TEXT,PAYC TEXT,PAYX TEXT,PBCT TEXT,PCAR TEXT,PEAK TEXT,PEG TEXT,PEP TEXT,PFE TEXT,PFG TEXT,PG TEXT,PGR TEXT,PH TEXT,PHM TEXT,PKG TEXT,PKI TEXT,PLD TEXT,PM TEXT,PNC TEXT,PNR TEXT,PNW TEXT,PPG TEXT,PPL TEXT,PRGO TEXT,PRU TEXT,PSA TEXT,PSX TEXT,PVH TEXT,PWR TEXT,PXD TEXT,PYPL TEXT,QCOM TEXT,QRVO TEXT,RCL TEXT,RE TEXT,REG TEXT,REGN TEXT,RF TEXT,RHI TEXT,RJF TEXT,RL TEXT,RMD TEXT,ROK TEXT,ROL TEXT,ROP TEXT,ROST TEXT,RSG TEXT,RTX TEXT,SBAC TEXT,SBUX TEXT,SCHW TEXT,SEE TEXT,SGEN TEXT,SHW TEXT,SIRI TEXT,SIVB TEXT,SJM TEXT,SLB TEXT,SLG TEXT,SNA TEXT,SNPS TEXT,SO TEXT,SPG TEXT,SPGI TEXT,SPLK TEXT,SRE TEXT,STE TEXT,STT TEXT,STX TEXT,STZ TEXT,SWK TEXT,SWKS TEXT,SYF TEXT,SYK TEXT,SYY TEXT,T TEXT,TAP TEXT,TCOM TEXT,TDG TEXT,TEL TEXT,TFC TEXT,TFX TEXT,TGT TEXT,TIF TEXT,TJX TEXT,TMO TEXT,TMUS TEXT,TPR TEXT,TROW TEXT,TRV TEXT,TSCO TEXT,TSLA TEXT,TSN TEXT,TT TEXT,TTWO TEXT,TWTR TEXT,TXN TEXT,TXT TEXT,UA TEXT,UAA TEXT,UAL TEXT,UDR TEXT,UHS TEXT,ULTA TEXT,UNH TEXT,UNM TEXT,UNP TEXT,UPS TEXT,URI TEXT,USB TEXT,V TEXT,VAR TEXT,VFC TEXT,VIAC TEXT,VLO TEXT,VMC TEXT,VNO TEXT,VRSK TEXT,VRSN TEXT,VRTX TEXT,VTR TEXT,VZ TEXT,WAB TEXT,WAT TEXT,WBA TEXT,WDAY TEXT,WDC TEXT,WEC TEXT,WELL TEXT,WFC TEXT,WHR TEXT,WLTW TEXT,WM TEXT,WMB TEXT,WMT TEXT,WRB TEXT,WRK TEXT,WST TEXT,WU TEXT,WY TEXT,WYNN TEXT,XEL TEXT,XLNX TEXT,XOM TEXT,XRAY TEXT,XRX TEXT,XYL TEXT,YUM TEXT,ZBH TEXT,ZBRA TEXT,ZION TEXT,ZTS TEXT,sp500_nas100_spread TEXT,LastTime timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP) engine=InnoDB  charset=utf8;



# drop table following_sp500_plus_nas100_20220412;
